# SAT Platform Backend Configuration
# Copy this file to .env and fill in the values

# =============================================================================
# Application
# =============================================================================
APP_NAME="SAT Platform API"
DEBUG=false
ENVIRONMENT=development  # development, staging, production

# =============================================================================
# Database
# =============================================================================
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=sat_platform

# Or use a full DATABASE_URL (e.g., from Heroku)
# DATABASE_URL=postgresql://user:pass@host:5432/db

# =============================================================================
# Redis (for Celery task queue)
# =============================================================================
REDIS_URL=redis://localhost:6379/0

# =============================================================================
# JWT Authentication
# =============================================================================
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=change-me-in-production-use-openssl-rand-hex-32
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=43200  # 30 days
REFRESH_TOKEN_EXPIRE_DAYS=60

# =============================================================================
# CORS Origins (comma-separated)
# =============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://127.0.0.1:5173

# =============================================================================
# S3 Storage (optional - for file uploads)
# =============================================================================
# S3_ENDPOINT_URL=https://s3.amazonaws.com  # or MinIO/DO Spaces URL
# S3_ACCESS_KEY_ID=your-access-key
# S3_SECRET_ACCESS_KEY=your-secret-key
# S3_BUCKET_NAME=sat-platform
# S3_REGION=us-east-1

# =============================================================================
# OCR Processing (for PDF import feature)
# =============================================================================

# API Keys (at least one required for OCR)
# OPENAI_API_KEY=sk-...  # For hybrid mode (gpt-4o-mini)
# DEEPINFRA_API_KEY=...  # For JSON structuring (DeepSeek)
OPENROUTER_API_KEY=...  # RECOMMENDED: Qwen 2.5 VL + DeepSeek (best price/performance)

# OCR Provider Configuration
# Providers: openai, deepinfra, hybrid, openrouter
# openrouter = Best price ($0.10/page) - uses Qwen 2.5 VL 32B + DeepSeek V3.2
# hybrid = OpenAI OCR + DeepInfra structuring ($0.25/page)
# openai = All OpenAI ($0.50/page) - most accurate but expensive
OCR_DEFAULT_PROVIDER=openrouter

# Performance Settings
# Rate limits: OpenRouter ~50 concurrent, OpenAI ~3-5 concurrent
OCR_MAX_CONCURRENT_PAGES=10  # Parallel API calls (safe for OpenRouter)
OCR_BATCH_SIZE=10  # Pages per checkpoint
OCR_API_TIMEOUT=120  # Seconds per API call
OCR_STRUCTURING_TIMEOUT=180

# Retry Settings
OCR_MAX_RETRIES=3
OCR_RETRY_DELAY=2  # Base delay for exponential backoff

# =============================================================================
# File Upload Limits
# =============================================================================
MAX_IMAGE_SIZE_MB=5
MAX_PDF_SIZE_MB=100
